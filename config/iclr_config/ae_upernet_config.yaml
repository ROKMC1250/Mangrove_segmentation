data:
  root_dir: 'datasets/GEE/sentinel-2_w0.45_0.1_0.45_split' # Path to the processed dataset with AE features
  
model:
  name: 'AEUperNet'
  args:
    encoder_name: 'tu-swin_tiny_patch4_window7_224' # Swin Transformer encoder for UperNet
    in_img: 6 # Number of satellite image channels (B, G, R, NIR, SWIR1, SWIR2)
    ae_dim: 64 # Number of AE feature channels
    D: 3 # Number of projected AE channels
    classes: 1 # Binary segmentation
    bce_weight: 2.0 # Weight for BCE loss in DiceBCE combination

train:
  seed: 42
  uid: 'ae_upernet_swin_tiny_v1' # Unique ID for this training run
  
  epoch: 50
  batch_size: 12  # Smaller batch size for Swin Transformer + AE features
  learning_rate: 0.0005  # Learning rate for Swin Transformer
  
  loss:
    name: 'AELoss'  # Custom multi-component loss
    lambda_sep: 0.1     # Weight for separability loss
    lambda_ortho: 0.0   # Disable orthogonality loss
    lambda_tv: 0.0      # Disable total variation loss
    lambda_mag: 0.0     # Weight for magnitude penalty
  
  optimizer:
    name: 'AdamW'
    args:
      weight_decay: 0.01
      betas: [0.9, 0.999]

  scheduler:
    name: 'CosineAnnealingWarmRestarts'
    args:
      T_0: 15 # Number of iterations for the first restart
      eta_min: 1.0e-6
      T_mult: 2

  log_dir: logs
  n_workers: 2  # Reduced for large AE dataset + transformer
  no_ddp: false
  no_save: false

  # Early Stopping
  patience: 20  # Enable early stopping for longer training
  
  # Image logging interval (in steps) for training
  log_image_interval: 200
